
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>skan.csr: CSR Graph representation of skeletons &#8212; Skan ü¶¥üìè 0.11.0.dev0 documentation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="skan.draw: Skeleton visualisation" href="skan.draw.html" />
    <link rel="prev" title="Skan API Reference" href="api.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    
<a class="navbar-brand" href="../index.html">
<p class="title">Skan ü¶¥üìè</p>
</a>

    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../getting_started/index.html">
  Getting started
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../examples/index.html">
  Examples
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="api.html">
  Skan API Reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../gui.html">
  Using Skan‚Äôs GUI
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../misc/index.html">
  Miscellaneous
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <div class="dropdown" id="version_switcher">
    <button type="button" class="btn btn-primary btn-sm navbar-btn dropdown-toggle" id="version_switcher_button" data-toggle="dropdown">
        0.11.0.dev0  <!-- this text may get changed later by javascript -->
        <span class="caret"></span>
    </button>
    <div id="version_switcher_menu" class="dropdown-menu list-group-flush py-0" aria-labelledby="version_switcher_button">
    <!-- dropdown will be populated by javascript on page load -->
    </div>
</div>

<!-- NOTE: this JS must live here (not in our global JS file) because it relies
     on being processed by Jinja before it is run (specifically for replacing
     variables api/skan.csr and {'json_url': 'https://skeleton-analysis.org/dev/_static/version_switcher.json', 'version_match': '0.11.0.dev0'}.
-->

<script type="text/javascript">
// Check if corresponding page path exists in other version of docs
// and, if so, go there instead of the homepage of the other docs version
function checkPageExistsAndRedirect(event) {
    const currentFilePath = "api/skan.csr.html",
          tryUrl = event.target.getAttribute("href");
    let otherDocsHomepage = tryUrl.replace(currentFilePath, "");
    $.ajax({
        type: 'HEAD',
        url: tryUrl,
        // if the page exists, go there
        success: function() {
            location.href = tryUrl;
        }
    }).fail(function() {
        location.href = otherDocsHomepage;
    });
    // this prevents the browser from following the href of the clicked node
    // (which is fine because this function takes care of redirecting)
    return false;
}

// Populate the version switcher from the JSON config file
(function () {
    $.getJSON("https://skeleton-analysis.org/dev/_static/version_switcher.json", function(data, textStatus, jqXHR) {
        const currentFilePath = "api/skan.csr.html";
        // create links to the corresponding page in the other docs versions
        $.each(data, function(index, entry) {
            // if no custom name specified (e.g., "latest"), use version string
            if (!("name" in entry)) {
                entry.name = entry.version;
            }
            // create the node
            const node = document.createElement("a");
            node.setAttribute("class", "list-group-item list-group-item-action py-1");
            node.textContent = `${entry.name}`;
            node.setAttribute("href", `${entry.url}${currentFilePath}`);
            // on click, AJAX calls will check if the linked page exists before
            // trying to redirect, and if not, will redirect to the homepage
            // for that version of the docs.
            node.onclick = checkPageExistsAndRedirect;
            // Add dataset values for the version and name in case people want
            // to apply CSS styling based on this information.
            node.dataset["versionName"] = entry.name;
            node.dataset["version"] = entry.version;

            $("#version_switcher_menu").append(node);
            // replace dropdown button text with the preferred display name of
            // this version, rather than using sphinx's 0.11.0.dev0 variable.
            // also highlight the dropdown entry for the currently-viewed
            // version's entry
            if (entry.version == "0.11.0.dev0") {
                node.classList.add("active");
                let btn = document.getElementById("version_switcher_button");
                btn.innerText = btn.dataset["activeVersionName"] = entry.name;
                btn.dataset["activeVersion"] = entry.version;
            }
        });
    });
})();
</script>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/jni/skan" rel="noopener" target="_blank" title="GitHub"><span><i class="fa-brands fa-square-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   skan.csr: CSR Graph representation of skeletons
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="skan.draw.html">
   skan.draw: Skeleton visualisation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="skan.pipe.html">
   skan.pipe:: Pipeline functions for skeleton analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="skan.pre.html">
   skan.pre: Image preprocessing
  </a>
 </li>
</ul>

  </div>
</nav>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                

<nav id="bd-toc-nav">
    
</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <section id="module-skan.csr">
<span id="skan-csr-csr-graph-representation-of-skeletons"></span><h1>skan.csr: CSR Graph representation of skeletons<a class="headerlink" href="#module-skan.csr" title="Permalink to this headline">#</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="skan.csr.Skeleton">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">skan.csr.</span></span><span class="sig-name descname"><span class="pre">Skeleton</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">skeleton_image</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spacing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_image</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_images</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value_is_height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/skan/csr.html#Skeleton"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#skan.csr.Skeleton" title="Permalink to this definition">#</a></dt>
<dd><p>Object to group together all the properties of a skeleton.</p>
<p>In the text below, we use the following notation:</p>
<ul class="simple">
<li><p>N: the number of points in the pixel skeleton,</p></li>
<li><p>ndim: the dimensionality of the skeleton</p></li>
<li><p>P: the number of paths in the skeleton (also the number of links in the
junction graph).</p></li>
<li><p>J: the number of junction nodes</p></li>
<li><p>Sd: the sum of the degrees of all the junction nodes</p></li>
<li><p>[Nt], [Np], Nr, Nc: the dimensions of the source image</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>skeleton_image</strong> (<em>array</em>) ‚Äì The input skeleton (1-pixel/voxel thick skeleton, all other values 0).</p></li>
<li><p><strong>spacing</strong> (float or array of float, shape <code class="docutils literal notranslate"><span class="pre">(ndim,)</span></code>) ‚Äì The scale of the pixel spacing along each axis.</p></li>
<li><p><strong>source_image</strong> (array of float, same shape as <cite>skeleton_image</cite>) ‚Äì The image that <cite>skeleton_image</cite> represents / summarizes / was generated
from. This is used to produce visualizations as well as statistical
properties of paths.</p></li>
<li><p><strong>keep_images</strong> (<em>bool</em>) ‚Äì Whether or not to keep the original input images. These can be useful
for visualization, but they may take up a lot of memory.</p></li>
<li><p><strong>value_is_height</strong> (<em>bool</em>) ‚Äì Whether to consider the value of a float skeleton to be the ‚Äúheight‚Äù
of the image. This can be useful e.g. when measuring lengths along
ridges in AFM images.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="skan.csr.Skeleton.graph">
<span class="sig-name descname"><span class="pre">graph</span></span><a class="headerlink" href="#skan.csr.Skeleton.graph" title="Permalink to this definition">#</a></dt>
<dd><p>The skeleton pixel graph, where each node is a non-zero pixel in the
input image, and each edge connects adjacent pixels. The graph is
represented as an adjacency matrix in SciPy sparse matrix format. For
more information see the <code class="docutils literal notranslate"><span class="pre">scipy.sparse</span></code> documentation as well as
<code class="docutils literal notranslate"><span class="pre">scipy.sparse.csgraph</span></code>. Note: pixel numbering starts at 1, so the
shape of this matrix is <code class="docutils literal notranslate"><span class="pre">(N</span> <span class="pre">+</span> <span class="pre">1,</span> <span class="pre">N</span> <span class="pre">+</span> <span class="pre">1)</span></code> instead of <code class="docutils literal notranslate"><span class="pre">(N,</span> <span class="pre">N)</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>scipy.sparse.csr_matrix, shape (N + 1, N + 1)</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="skan.csr.Skeleton.nbgraph">
<span class="sig-name descname"><span class="pre">nbgraph</span></span><a class="headerlink" href="#skan.csr.Skeleton.nbgraph" title="Permalink to this definition">#</a></dt>
<dd><p>A thin Numba wrapper around the <code class="docutils literal notranslate"><span class="pre">csr_matrix</span></code> format, this provides
faster graph methods. For example, it is much faster to get a list of
neighbors, or test for the presence of a specific edge.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>NBGraph</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="skan.csr.Skeleton.coordinates">
<span class="sig-name descname"><span class="pre">coordinates</span></span><a class="headerlink" href="#skan.csr.Skeleton.coordinates" title="Permalink to this definition">#</a></dt>
<dd><p>skeleton_pixel_id i -&gt; coordinates[i]
The image coordinates of each pixel in the skeleton.
Some values in this matrix are non-sensical ‚Äî you should only access
them from node ids.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>array, shape (N, ndim)</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="skan.csr.Skeleton.paths">
<span class="sig-name descname"><span class="pre">paths</span></span><a class="headerlink" href="#skan.csr.Skeleton.paths" title="Permalink to this definition">#</a></dt>
<dd><p>A csr_matrix where element [i, j] is on if node j is in path i. This
includes path endpoints. The number of nonzero elements is N - J + Sd.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>scipy.sparse.csr_matrix, shape (P, N + 1)</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="skan.csr.Skeleton.n_paths">
<span class="sig-name descname"><span class="pre">n_paths</span></span><a class="headerlink" href="#skan.csr.Skeleton.n_paths" title="Permalink to this definition">#</a></dt>
<dd><p>The number of paths, P. This is redundant information given <cite>n_paths</cite>,
but it is used often enough that it is worth keeping around.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="skan.csr.Skeleton.distances">
<span class="sig-name descname"><span class="pre">distances</span></span><a class="headerlink" href="#skan.csr.Skeleton.distances" title="Permalink to this definition">#</a></dt>
<dd><p>The distance of each path. Note: not initialized until <cite>path_lengths()</cite>
is called on the skeleton; use path_lengths() instead</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>array of float, shape (P,)</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="skan.csr.Skeleton.skeleton_image">
<span class="sig-name descname"><span class="pre">skeleton_image</span></span><a class="headerlink" href="#skan.csr.Skeleton.skeleton_image" title="Permalink to this definition">#</a></dt>
<dd><p>The input skeleton image. Only present if <cite>keep_images</cite> is True. Set to
False to preserve memory.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>array or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="skan.csr.Skeleton.source_image">
<span class="sig-name descname"><span class="pre">source_image</span></span><a class="headerlink" href="#skan.csr.Skeleton.source_image" title="Permalink to this definition">#</a></dt>
<dd><p>The image from which the skeleton was derived. Only present if
<cite>keep_images</cite> is True. This is useful for visualization.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>array or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="skan.csr.Skeleton.path">
<span class="sig-name descname"><span class="pre">path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/skan/csr.html#Skeleton.path"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#skan.csr.Skeleton.path" title="Permalink to this definition">#</a></dt>
<dd><p>Return the pixel indices of path number <cite>index</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>index</strong> (<em>int</em>) ‚Äì The desired path.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>path</strong> ‚Äì The indices of the pixels belonging to the path, including
endpoints.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array of int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="skan.csr.Skeleton.path_coordinates">
<span class="sig-name descname"><span class="pre">path_coordinates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/skan/csr.html#Skeleton.path_coordinates"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#skan.csr.Skeleton.path_coordinates" title="Permalink to this definition">#</a></dt>
<dd><p>Return the image coordinates of the pixels in the path.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>index</strong> (<em>int</em>) ‚Äì The desired path.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>path_coords</strong> ‚Äì The (image) coordinates of points on the path, including endpoints.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array of float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="skan.csr.Skeleton.path_label_image">
<span class="sig-name descname"><span class="pre">path_label_image</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/skan/csr.html#Skeleton.path_label_image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#skan.csr.Skeleton.path_label_image" title="Permalink to this definition">#</a></dt>
<dd><p>Image like self.skeleton_image with path_ids as values.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>label_image</strong> ‚Äì Image of the same shape as self.skeleton_image where each pixel
has the value of its branch id + 1.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array of ints</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="skan.csr.Skeleton.path_lengths">
<span class="sig-name descname"><span class="pre">path_lengths</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/skan/csr.html#Skeleton.path_lengths"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#skan.csr.Skeleton.path_lengths" title="Permalink to this definition">#</a></dt>
<dd><p>Return the length of each path on the skeleton.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>lengths</strong> ‚Äì The length of all the paths in the skeleton.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array of float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="skan.csr.Skeleton.path_means">
<span class="sig-name descname"><span class="pre">path_means</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/skan/csr.html#Skeleton.path_means"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#skan.csr.Skeleton.path_means" title="Permalink to this definition">#</a></dt>
<dd><p>Compute the mean pixel value along each path.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>means</strong> ‚Äì The average pixel value along each path in the skeleton.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array of float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="skan.csr.Skeleton.path_stdev">
<span class="sig-name descname"><span class="pre">path_stdev</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/skan/csr.html#Skeleton.path_stdev"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#skan.csr.Skeleton.path_stdev" title="Permalink to this definition">#</a></dt>
<dd><p>Compute the standard deviation of values along each path.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>stdevs</strong> ‚Äì The standard deviation of pixel values along each path.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array of float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="skan.csr.Skeleton.path_with_data">
<span class="sig-name descname"><span class="pre">path_with_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/skan/csr.html#Skeleton.path_with_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#skan.csr.Skeleton.path_with_data" title="Permalink to this definition">#</a></dt>
<dd><p>Return pixel indices and corresponding pixel values on a path.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>index</strong> (<em>int</em>) ‚Äì The desired path.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>path</strong> (<em>array of int</em>) ‚Äì The indices of pixels on the path, including endpoints.</p></li>
<li><p><strong>data</strong> (<em>array of float</em>) ‚Äì The values of pixels on the path.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="skan.csr.Skeleton.paths_list">
<span class="sig-name descname"><span class="pre">paths_list</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/skan/csr.html#Skeleton.paths_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#skan.csr.Skeleton.paths_list" title="Permalink to this definition">#</a></dt>
<dd><p>List all the paths in the skeleton, including endpoints.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>paths</strong> ‚Äì The list containing all the paths in the skeleton.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list of array of int</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="skan.csr.make_degree_image">
<span class="sig-prename descclassname"><span class="pre">skan.csr.</span></span><span class="sig-name descname"><span class="pre">make_degree_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">skeleton_image</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/skan/csr.html#make_degree_image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#skan.csr.make_degree_image" title="Permalink to this definition">#</a></dt>
<dd><p>Create a array showing the degree of connectivity of each pixel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>skeleton_image</strong> (<em>array</em>) ‚Äì An input image in which every nonzero pixel is considered part of
the skeleton, and links between pixels are determined by a full
n-dimensional neighborhood.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>degree_image</strong> ‚Äì An image containing the degree of connectivity of each pixel in the
skeleton to neighboring pixels.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array of int, same shape as skeleton_image</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="skan.csr.pixel_graph">
<span class="sig-prename descclassname"><span class="pre">skan.csr.</span></span><span class="sig-name descname"><span class="pre">pixel_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">connectivity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spacing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/skan/csr.html#pixel_graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#skan.csr.pixel_graph" title="Permalink to this definition">#</a></dt>
<dd><p>Create an adjacency graph of pixels in an image.</p>
<p>Pixels where the mask is True are nodes in the returned graph, and they are
connected by edges to their neighbors according to the connectivity
parameter. By default, the <em>value</em> of an edge when a mask is given, or when
the image is itself the mask, is the euclidean distance betwene the pixels.</p>
<p>However, if an int- or float-valued image is given with no mask, the value
of the edges is the absolute difference in intensity between adjacent
pixels, weighted by the euclidean distance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>array</em>) ‚Äì The input image. If the image is of type bool, it will be used as the
mask as well.</p></li>
<li><p><strong>mask</strong> (<em>array of bool</em>) ‚Äì Which pixels to use. If None, the graph for the whole image is used.</p></li>
<li><p><strong>edge_function</strong> (<em>callable</em>) ‚Äì A function taking an array of pixel values, and an array of neighbor
pixel values, and an array of distances, and returning a value for the
edge. If no function is given, the value of an edge is just the
distance.</p></li>
<li><p><strong>connectivity</strong> (<em>int</em>) ‚Äì The square connectivity of the pixel neighborhood: the number of
orthogonal steps allowed to consider a pixel a neigbor. See
<cite>scipy.ndimage.generate_binary_structure</cite> for details.</p></li>
<li><p><strong>spacing</strong> (<em>tuple of float</em>) ‚Äì The spacing between pixels along each axis.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>graph</strong> (<em>scipy.sparse.csr_matrix</em>) ‚Äì A sparse adjacency matrix in which entry (i, j) is 1 if nodes i and j
are neighbors, 0 otherwise.</p></li>
<li><p><strong>nodes</strong> (<em>array of int</em>) ‚Äì The nodes of the graph. These correspond to the raveled indices of the
nonzero pixels in the mask.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="skan.csr.sholl_analysis">
<span class="sig-prename descclassname"><span class="pre">skan.csr.</span></span><span class="sig-name descname"><span class="pre">sholl_analysis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">skeleton</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shells</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/skan/csr.html#sholl_analysis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#skan.csr.sholl_analysis" title="Permalink to this definition">#</a></dt>
<dd><p>Sholl Analysis for Skeleton object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>skeleton</strong> (<a class="reference internal" href="#skan.csr.Skeleton" title="skan.csr.Skeleton"><em>skan.csr.Skeleton</em></a>) ‚Äì A Skeleton object.</p></li>
<li><p><strong>center</strong> (<em>array-like of float</em><em> or </em><em>None</em><em>, </em><em>optional</em>) ‚Äì Scaled coordinates of a point on the skeleton to use as the center
from which the concentric shells are computed. If None, the
geodesic center of skeleton is chosen.</p></li>
<li><p><strong>shells</strong> (<em>int</em><em> or </em><em>array of floats</em><em> or </em><em>None</em><em>, </em><em>optional</em>) ‚Äì If an int, it is used as number of evenly spaced concentric shells. If
an array of floats, it is used directly as the different shell radii in
real world units. If None, the number of evenly spaced concentric
shells is automatically calculated.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>center</strong> (<em>array of float</em>) ‚Äì The scaled coordinates in real world units of the center of the shells.
(This might be provided as input, but it might also have been computed
within this function, and that computation is expensive, so we return
it just in case.)</p></li>
<li><p><strong>shell_radii</strong> (<em>array of float</em>) ‚Äì Radii in real world units for concentric shells used for analysis.</p></li>
<li><p><strong>intersection_counts</strong> (<em>array of int</em>) ‚Äì Number of intersections for corresponding shell radii.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="skan.csr.skeleton_to_csgraph">
<span class="sig-prename descclassname"><span class="pre">skan.csr.</span></span><span class="sig-name descname"><span class="pre">skeleton_to_csgraph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">skel</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spacing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value_is_height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/skan/csr.html#skeleton_to_csgraph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#skan.csr.skeleton_to_csgraph" title="Permalink to this definition">#</a></dt>
<dd><p>Convert a skeleton image of thin lines to a graph of neighbor pixels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>skel</strong> (<em>array</em>) ‚Äì An input image in which every nonzero pixel is considered part of
the skeleton, and links between pixels are determined by a full
n-dimensional neighborhood.</p></li>
<li><p><strong>spacing</strong> (float, or array-like of float, shape <cite>(skel.ndim,)</cite>) ‚Äì A value indicating the distance between adjacent pixels. This can
either be a single value if the data has the same resolution along
all axes, or it can be an array of the same shape as <cite>skel</cite> to
indicate spacing along each axis.</p></li>
<li><p><strong>value_is_height</strong> (<em>bool</em><em>, </em><em>optional</em>) ‚Äì If <cite>True</cite>, the pixel value at each point of the skeleton will be
considered to be a height measurement, and this height will be
incorporated into skeleton branch lengths. Used for analysis of
atomic force microscopy (AFM) images.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>graph</strong> (<em>sparse.csr_matrix</em>) ‚Äì A graph of shape (Nnz, Nnz), where Nnz is the number of
nonzero pixels in <cite>skel</cite>. The value graph[i, j] is the distance
between adjacent pixels i and j. In a 2D image, that would be
1 for immediately adjacent pixels and sqrt(2) for diagonally
adjacent ones.</p></li>
<li><p><strong>pixel_coordinates</strong> (<em>array of float</em>) ‚Äì An array of shape (Nnz, skel.ndim), mapping indices in <cite>graph</cite>
to pixel coordinates in <cite>skel</cite>.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="skan.csr.submatrix">
<span class="sig-prename descclassname"><span class="pre">skan.csr.</span></span><span class="sig-name descname"><span class="pre">submatrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">M</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idxs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/skan/csr.html#submatrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#skan.csr.submatrix" title="Permalink to this definition">#</a></dt>
<dd><p>Return the outer-index product submatrix, <cite>M[idxs, :][:, idxs]</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>M</strong> (<em>scipy.sparse.spmatrix</em>) ‚Äì Input (square) matrix</p></li>
<li><p><strong>idxs</strong> (<em>array of int</em>) ‚Äì The indices to subset. No index in <cite>idxs</cite> should exceed the
number of rows of <cite>M</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>Msub</strong> ‚Äì The subsetted matrix.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>scipy.sparse.spmatrix</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Md</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">sparse</span><span class="o">.</span><span class="n">csr_matrix</span><span class="p">(</span><span class="n">Md</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">submatrix</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">toarray</span><span class="p">())</span>
<span class="go">[[ 0  2]</span>
<span class="go"> [ 8 10]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="skan.csr.summarize">
<span class="sig-prename descclassname"><span class="pre">skan.csr.</span></span><span class="sig-name descname"><span class="pre">summarize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">skel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#skan.csr.Skeleton" title="skan.csr.Skeleton"><span class="pre">skan.csr.Skeleton</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value_is_height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">find_main_branch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/skan/csr.html#summarize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#skan.csr.summarize" title="Permalink to this definition">#</a></dt>
<dd><p>Compute statistics for every skeleton and branch in <code class="docutils literal notranslate"><span class="pre">skel</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>skel</strong> (<a class="reference internal" href="#skan.csr.Skeleton" title="skan.csr.Skeleton"><em>skan.csr.Skeleton</em></a>) ‚Äì A Skeleton object.</p></li>
<li><p><strong>value_is_height</strong> (<em>bool</em>) ‚Äì Whether to consider the value of a float skeleton to be the ‚Äúheight‚Äù
of the image. This can be useful e.g. when measuring lengths along
ridges in AFM images.</p></li>
<li><p><strong>find_main_branch</strong> (<em>bool</em><em>, </em><em>optional</em>) ‚Äì Whether to compute main branches. A main branch is defined as the
longest shortest path within a skeleton. This step is very expensive
as it involves computing the shortest paths between all pairs of branch
endpoints, so it is off by default.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>summary</strong> ‚Äì A summary of the branches including branch length, mean branch value,
branch euclidean distance, etc.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

</section>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="api.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Skan API Reference</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="skan.draw.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">skan.draw: Skeleton visualisation</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
              
          </main>
          

      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2021, Juan Nunez-Iglesias &amp; skan contributors.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>